#It is generated by the source task as:create_aci_epg.yml
  - name: 3a Post Query EPGs in App Profiles
    aci_epg:
     host: "{{ inventory_hostname }}"
     username: "{{ username }}"
     password: "{{ password }}"
     tenant: "{{ item.tenantName }}"
     bd: "{{ item.bdName }}"
     ap: "{{ item.apName }}"
     epg: "{{ item.epgName }}"
     preferred_group: "{{ item.epgPrefGroup }}"
     intra_epg_isolation: "{{ item.epgIntraIso }}"
     fwd_control: "{{ item.epgProxyArp }}"
     description: "{{ item.epgDesc }}"
     validate_certs: no
     state: query
    register: query_result
    with_items: "{{ aci_epg }}"
    delegate_to: localhost


  - name: Assert the existing object
    assert:
      that:
      - item.current == []
      success_msg: "Object does not exist. Can create it."
      fail_msg: "Object exists. DO NOT recreate it!"
    with_items: "{{query_result.results}}"

